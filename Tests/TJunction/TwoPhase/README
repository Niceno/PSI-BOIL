Please check lagrangian_collision.cpp for detailed "erase" conditions
